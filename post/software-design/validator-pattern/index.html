<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Software Design - Validator Pattern</title>
    
    <meta name="description" content="I build things">
    
    

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    
    
    <link rel="stylesheet" href="https://eddieabbondanz.io/sass/main.min.cfaf5a82ddb1997768713c5494447077b834f7a9145e7079037250a4029c50af.css" integrity="sha256-z69agt2xmXdocTxUlERwd7g096kUXnB5A3JQpAKcUK8=" media="screen">

    <script src="https://eddieabbondanz.io/js/interactivity.js"></script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-128571017-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>

<body class="has-background-light">
    

    <section class="hero is-halfheight is-primary">
      

      <div class="hero-head">
        <nav class="navbar is-transparent is-spaced" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item title is-uppercase is-marginless has-text-white is-size-5" href="https://eddieabbondanz.io">
      EddieAbbondanz.io
    </a>

    <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="hamburger-menu">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="hamburger-menu" class="navbar-menu">
    <div class="navbar-end">
      
      <a class="navbar-item" href="https://eddieabbondanz.io/post" style="text-decoration: none!important;">Posts</a>
      
      <a class="navbar-item" href="https://eddieabbondanz.io/about" style="text-decoration: none!important;">About Me</a>
      
      <a class="navbar-item" href="https://eddieabbondanz.io/portfolio" style="text-decoration: none!important;">Portfolio</a>
       
      <a class="navbar-item" href="http://github.com/EddieAbbondanzio" target="_blank">
        GitHub
      </a>
      
    </div>
  </div>
</nav>
      </div>

      <div class="hero-foot">
        <div class="container">
          <header>
    <div class="post-header has-text-white has-margin-all-4-touch has-margin-bottom-4-desktop">

        
        <div class="has-margin-bottom-0">
            
            <h1 class="has-margin-bottom-0 is-size-2 is-size-4-touch">
                Software Design - Validator Pattern
            </h1>
            

            
            
            
        </div>

        
        <div class="is-flex-desktop flex-row  has-text-grey-lighter">
            
            <div class="is-flex is-flex-row is-align-middle  has-margin-right-3" title="Date posted">
                <i class="material-icons has-text-grey-light has-margin-right-1">today</i>
                <time class="has-text-grey-lighter">Oct 10, 2018</time>
            </div>
            
        </div>
    </div>
</header>
        </div>
      </div>
    </section>
  </section>
</section>

    <main class="container has-background-white">
        
<article>
    <h2 id="validating-objects-based-on-context">Validating Objects Based on Context</h2>
<p>It&rsquo;s quite typical for a Domain Driven Design (DDD) project to need validation for it&rsquo;s domain models. While it may be sufficient to solve this by adding an IsValid() method to each model, this can cause confusion for the developer by cluttering the model class, and/or by requiring the IsValid() method to be generalized that it covers a large range of validation rules for any situation that may arise. Let&rsquo;s work with an example.</p>
<p>Imagine there is an User object like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c#" data-lang="c#">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Username { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Password { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> IsDeleted { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }

        <span style="color:#66d9ef">public</span> User(<span style="color:#66d9ef">string</span> username, <span style="color:#66d9ef">string</span> password) {
            Username = username;
            Password = password;
        }
    }
</code></pre></div><p>We need a way that we can validate users before adding them to the database. This could be achieved by adding the IsValid() method as mentioned earlier.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c#" data-lang="c#">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> {
        ...

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> IsValid() {
            <span style="color:#66d9ef">if</span>(!<span style="color:#66d9ef">string</span>.IsNullOrEmpty(Username) &amp;&amp; !<span style="color:#66d9ef">string</span>.IsNullOrEmpty(Password)) {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
            }
            <span style="color:#66d9ef">else</span> {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
            }
        }
    }
</code></pre></div><p>This solves the problem by checking that both a Username, and Password have been defined, and if not returns false. However, what do we do when we also need to handle validating that a user hasn&rsquo;t been deleted already before allowing it to be deleted? We could add an IsValidToDelete() method to the class but this is just starting to clutter things, and seems like a pretty bad approach. On the other hand we could simply call IsValid before deleting but then any user we want to delete would have to have a valid username, and password which makes no sense.</p>
<p>To overcome this issue we can introduce the concept of validators. Validators utilize the <a href="https://en.wikipedia.org/wiki/Visitor_pattern">visitor pattern</a> to separate the validaiton logic from the model itself. Let&rsquo;s define an interface for all validators to derive from.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c#" data-lang="c#">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> IValidator&lt;T&gt; {
        <span style="color:#66d9ef">bool</span> Validate(T entity);
    }
</code></pre></div><p>Now we can define two validators, one to handle users when created, and another to handle users when deleted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c#" data-lang="c#">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserCreationValidator</span> : IValidator&lt;User&gt; {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> Validate(User user) {
            <span style="color:#66d9ef">if</span> (!<span style="color:#66d9ef">string</span>.IsNullOrEmpty(user.Username) &amp;&amp; !<span style="color:#66d9ef">string</span>.IsNullOrEmpty(user.Password)) {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
            }
            <span style="color:#66d9ef">else</span> {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
            }
        }
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserDeletionValidator</span> : IValidator&lt;User&gt; {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> Validate(User user) {
            <span style="color:#66d9ef">return</span> !user.IsDeleted;
        }
    }
</code></pre></div><p>Then in our UserController class we could handle validation like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c#" data-lang="c#">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserController</span> {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> AddUser(User user) {
            UserCreationValidator validator = <span style="color:#66d9ef">new</span> UserCreationValidator();

            <span style="color:#66d9ef">if</span> (validator.Validate(user)) {
                <span style="color:#75715e">//Add the user
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
            }
            <span style="color:#66d9ef">else</span> {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
            }
        }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> DeleteUser(User user) {
            UserDeletionValidator validator = <span style="color:#66d9ef">new</span> UserDeletionValidator();

            <span style="color:#66d9ef">if</span> (validator.Validate(user)) {
                <span style="color:#75715e">//Delete the user
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
            }
            <span style="color:#66d9ef">else</span> {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
            }
        }
    }
</code></pre></div><p>This helps maintain the single role principle for each of our classes, and enables us to handle validating based on context in a way that can scale nicely.</p>

</article>

    </main>

    <footer>
    <p>&copy; 2020 <a href="https://eddieabbondanz.io">Eddie Abbondanzio</a></p>
</footer> </body>
</html>